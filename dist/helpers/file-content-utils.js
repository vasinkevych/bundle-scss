"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const constants_1 = require("./constants");
const fs_utils_1 = require("./fs-utils");
const path_1 = require("path");
exports.removeImports = (content) => content.replace(constants_1.mainConst.sassImportRegex, '');
exports.getUniqueScss = (files) => {
    const scssImports = files
        .map(file => {
        let baseDir = path_1.dirname(file);
        return exports.getImports(fs_utils_1.readSync(file), baseDir);
    })
        .reduce((acc, curr) => acc.concat(curr), []);
    const allImports = [...scssImports, ...files];
    return [...new Set(allImports)];
};
exports.getImports = (content, baseDir, imports = []) => {
    const regex = /@import ['"]([^'"]+)['"];/g;
    let match;
    while ((match = regex.exec(content)) !== null) {
        const pathFile = fs_utils_1.defineExtension(path_1.join(baseDir, match[1]));
        imports.push(pathFile);
        exports.getImports(fs_utils_1.readSync(pathFile), path_1.dirname(pathFile), imports);
    }
    return imports;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS1jb250ZW50LXV0aWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2hlbHBlcnMvZmlsZS1jb250ZW50LXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsMkNBQXdDO0FBQ3hDLHlDQUF1RDtBQUN2RCwrQkFBcUM7QUFFeEIsUUFBQSxhQUFhLEdBQUcsQ0FBQyxPQUFlLEVBQUUsRUFBRSxDQUMvQyxPQUFPLENBQUMsT0FBTyxDQUFDLHFCQUFTLENBQUMsZUFBZSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBRXBDLFFBQUEsYUFBYSxHQUFHLENBQUMsS0FBb0IsRUFBRSxFQUFFO0lBQ3BELE1BQU0sV0FBVyxHQUFHLEtBQUs7U0FDdEIsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ1YsSUFBSSxPQUFPLEdBQUcsY0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVCLE1BQU0sQ0FBQyxrQkFBVSxDQUFDLG1CQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0MsQ0FBQyxDQUFDO1NBQ0QsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMvQyxNQUFNLFVBQVUsR0FBRyxDQUFDLEdBQUcsV0FBVyxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7SUFFOUMsTUFBTSxDQUFDLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO0FBQ2xDLENBQUMsQ0FBQztBQUVXLFFBQUEsVUFBVSxHQUFHLENBQ3hCLE9BQWUsRUFDZixPQUFlLEVBQ2YsVUFBeUIsRUFBRSxFQUMzQixFQUFFO0lBQ0YsTUFBTSxLQUFLLEdBQUcsNEJBQTRCLENBQUM7SUFDM0MsSUFBSSxLQUFLLENBQUM7SUFDVixPQUFPLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQztRQUM5QyxNQUFNLFFBQVEsR0FBRywwQkFBZSxDQUFDLFdBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxRCxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3ZCLGtCQUFVLENBQUMsbUJBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxjQUFPLENBQUMsUUFBUSxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0QsQ0FBQztJQUVELE1BQU0sQ0FBQyxPQUFPLENBQUM7QUFDakIsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbWFpbkNvbnN0IH0gZnJvbSAnLi9jb25zdGFudHMnO1xyXG5pbXBvcnQgeyBkZWZpbmVFeHRlbnNpb24sIHJlYWRTeW5jIH0gZnJvbSAnLi9mcy11dGlscyc7XHJcbmltcG9ydCB7IGRpcm5hbWUsIGpvaW4gfSBmcm9tICdwYXRoJztcclxuXHJcbmV4cG9ydCBjb25zdCByZW1vdmVJbXBvcnRzID0gKGNvbnRlbnQ6IHN0cmluZykgPT5cclxuICBjb250ZW50LnJlcGxhY2UobWFpbkNvbnN0LnNhc3NJbXBvcnRSZWdleCwgJycpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFVuaXF1ZVNjc3MgPSAoZmlsZXM6IEFycmF5PHN0cmluZz4pID0+IHtcclxuICBjb25zdCBzY3NzSW1wb3J0cyA9IGZpbGVzXHJcbiAgICAubWFwKGZpbGUgPT4ge1xyXG4gICAgICBsZXQgYmFzZURpciA9IGRpcm5hbWUoZmlsZSk7XHJcbiAgICAgIHJldHVybiBnZXRJbXBvcnRzKHJlYWRTeW5jKGZpbGUpLCBiYXNlRGlyKTtcclxuICAgIH0pXHJcbiAgICAucmVkdWNlKChhY2MsIGN1cnIpID0+IGFjYy5jb25jYXQoY3VyciksIFtdKTtcclxuICBjb25zdCBhbGxJbXBvcnRzID0gWy4uLnNjc3NJbXBvcnRzLCAuLi5maWxlc107XHJcblxyXG4gIHJldHVybiBbLi4ubmV3IFNldChhbGxJbXBvcnRzKV07XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW1wb3J0cyA9IChcclxuICBjb250ZW50OiBzdHJpbmcsXHJcbiAgYmFzZURpcjogc3RyaW5nLFxyXG4gIGltcG9ydHM6IEFycmF5PHN0cmluZz4gPSBbXVxyXG4pID0+IHtcclxuICBjb25zdCByZWdleCA9IC9AaW1wb3J0IFsnXCJdKFteJ1wiXSspWydcIl07L2c7XHJcbiAgbGV0IG1hdGNoO1xyXG4gIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKGNvbnRlbnQpKSAhPT0gbnVsbCkge1xyXG4gICAgY29uc3QgcGF0aEZpbGUgPSBkZWZpbmVFeHRlbnNpb24oam9pbihiYXNlRGlyLCBtYXRjaFsxXSkpO1xyXG4gICAgaW1wb3J0cy5wdXNoKHBhdGhGaWxlKTtcclxuICAgIGdldEltcG9ydHMocmVhZFN5bmMocGF0aEZpbGUpLCBkaXJuYW1lKHBhdGhGaWxlKSwgaW1wb3J0cyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gaW1wb3J0cztcclxufTtcclxuIl19